## 同步机制
任务的同步机制是任务之间为得到预期结果而进行的协调。  

在并发应用程序中，有两种同步机制。
-	进程同步：  
想要控制任务的执行顺序时，就可以使用这种同步。  
例如，一个任务必须等待另一任务终止才开始执行。

-	数据同步：  
当两个或多个任务访问同一内存对象时，可以使用这种同步。  
在这种情况下，必须保护写入操作对该对象的访问权限。  
如果不这样做，就会出现数据竞争条件，一个程序的最终结果在每次执行时都不同。

Java 并发 API 提供了多种机制，让你可以实现上述两种类型的同步。  

### synchronized
Java 语言提供的最基本的同步机制是 synchronized 关键字。  
该关键字可应用于某个方法或者某个代码块。  
对于第一种情况，一次只有一个线程可以执行该方法。  
对于第二种情况，要指定一个对某个对象的引用。  
在这种情况下，同时只能执行被某一对象保护的一个代码块。

### 其他同步机制
Java 也提供了其他一些同步机制。
-	Lock 接口及其实现类：  
该机制允许你实现一个临界段，保证只有一个线程执行该代码块。

-	Semaphore 类  
实现了由 Edsger Dijkstra 提出的著名的信号量同步机制。
-	CountDownLatch   
允许你实现这样的场景：一个或多个线程等待其他线程结束。
-	CyclicBarrier   
允许你将不同的任务同步到某个共同的节点。
-	Phaser 类  
允许你分为多个阶段实现并发任务。
-	Exchanger   
允许你在两个线程之间实现一个数据交换点。
-	CompletableFuture   
是Java 8的新特性，它扩展了执行器任务的 Future 机制，以一种异步方式生成任务的结果。  
可以指定任务在结果生成之后执行，这样就可以控制任务的执行顺序。

### 详细介绍
#### CommonTask 类
[CommonTask](CommonTask.java) 类将在随机的一段时间（0 到 10 秒）内将调用线程休眠。  

#### Lock 接口
[Lock 接口](J22Lock.java) 基本实现类是 ReentrantLock 类。

#### Semaphore 类
信号量机制用于控制对一个或多个共享资源的访问。  

该机制基于一个内部计数器以及两个名为 wait() 和 signal() 的方法。  

当一个线程调用了 wait() 方法时：
-	如果内部计数器的值大于 0，那么信号量对内部计数器做递减操作，并且该线程获得对该共享资源的访问。

-	如果内部计数器的值为 0，那么线程将被阻塞，直到某个线程调用 singal() 方法为止。  

当一个线程调用了 signal() 方法时，信号量将会检查是否有某些线程处于等待状态（它们已经调用了 wait() 方法）。
-	如果没有线程等待，它将对内部计数器做递增操作。

-	如果有线程在等待信号量，就获取这其中的一个线程，该线程的 wait() 方法结束返回并且访问共享资源。其他线程将继续等待，直到轮到自己为止。

在 Java 中，信号量在 Semaphore 类中实现。   
wait() 方法被称作 acquire() ，而 signal() 方法被称作 release() 。  

[Semaphore 类](J23Semaphore.java) 

#### CountDownLatch 类 
CountDownLatch类提供了一种等待一个或多个并发任务完成的机制。
  
它有一个内部计数器，必须使用要等待的任务数初始化。   
然后， await() 方法休眠调用线程，直到内部计数器为 0，并且使用 countDown()方法对该内部计数器做递减操作。  

[CountDownLatch 类](J24CountDownLatch.java)  

#### CyclicBarrier 类
CyclicBarrier类允许将一些任务同步到某个共同点。  
所有的任务都在该点等待，直到任务全部到达该点为止。  

从内部来看，该类还管理了一个内部计数器，用于记录尚未到达该点的任务。  
当一个任务到达指定点时，它要执行 await() 方法以等待其他任务。  
当所有任务都到达时， CyclicBarrier 对象将它们唤醒，这样就能够继续执行。  
当所有的参与方都到达后，该类允许执行另一个任务。  

为了实现这一点，要在该对象的构造函数中指定一个 Runnable 对象。

[CyclicBarrier 类](J25CyclicBarrier.java)  

#### CompletableFuture 类
[CompletableFuture 类](C26.CompletableFuture类.md) 

